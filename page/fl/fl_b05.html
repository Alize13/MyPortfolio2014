<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>無標題文件</title>
<link href="../../Assert/css/layout.css" rel="stylesheet" type="text/css" />
</head>

<body>
<div id="inCC">
<h1>圖片輪播</h1>
<h2>做出圖片輪播的效果但是讓使用者也可以自由點選</h2>
<p>&nbsp;</p>
<h3>作品展示</h3>
<p>
  <object id="FlashID" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="621" height="297">
    <param name="movie" value="../../Assert/media/banner.swf" />
    <param name="quality" value="high" />
    <param name="wmode" value="opaque" />
    <param name="swfversion" value="15.0.0.0" />
    <!-- 此 param 標籤會提示使用 Flash Player 6.0 r65 和更新版本的使用者下載最新版本的 Flash Player。如果您不想讓使用者看到這項提示，請將其刪除。 -->
    <param name="expressinstall" value="../../Scripts/expressInstall.swf" />
    <!-- 下一個物件標籤僅供非 IE 瀏覽器使用。因此，請使用 IECC 將其自 IE 隱藏。 -->
    <!--[if !IE]>-->
    <object type="application/x-shockwave-flash" data="../../Assert/media/banner.swf" width="621" height="297">
      <!--<![endif]-->
      <param name="quality" value="high" />
      <param name="wmode" value="opaque" />
      <param name="swfversion" value="15.0.0.0" />
      <param name="expressinstall" value="../../Scripts/expressInstall.swf" />
      <!-- 瀏覽器會為使用 Flash Player 6.0 和更早版本的使用者顯示下列替代內容。 -->
      <div>
        <h4>這個頁面上的內容需要較新版本的 Adobe Flash Player。</h4>
        <p><a href="http://www.adobe.com/go/getflashplayer"><img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="取得 Adobe Flash Player" width="112" height="33" /></a></p>
      </div>
      <!--[if !IE]>-->
    </object>
    <!--<![endif]-->
  </object>
</p>
<h3>程式碼</h3>
<pre class="brush: as3">
var i = 1;//宣告變數i用來紀錄目前播放第幾張
var setintervalId:uint;
var prev = 1;
n1.stop();
n2.stop();
n3.stop();
n4.stop();
n1.buttonMode=true;
n2.buttonMode=true;
n3.buttonMode=true;
n4.buttonMode=true;
function $nextPic()
{
	//判斷是否i等於5,如果是就還原成1
	if (i==5)
	{
		i = 1;
	}
	h_mc.gotoAndPlay(25);

	this["n" + prev].gotoAndStop(1);//將前一個按鈕還原

	this["c" + i].gotoAndPlay(1);
	//指定實體名稱為ci的影片片段從第一格播放;
	this.addChild(this["c"+i]);
	//指定實體名稱為ci的影片片段移至最上層;
	this["n" + i].gotoAndStop(2);
	this.addChild(numbg);//所有按鈕移至最上層
	this.addChild(n1);
	this.addChild(n2);
	this.addChild(n3);
	this.addChild(n4);
	this.addChild(h_mc);
	prev = i;
	i++;//將變數i+1
}

$nextPic();
setintervalId = setInterval($nextPic,4000);//每隔4000毫秒執行一次函式$nextPic


n1.addEventListener(MouseEvent.CLICK,$playPic1);
function $playPic1($e:MouseEvent)
{
	h_mc.gotoAndPlay(25);
	c1.gotoAndPlay(1);
	this.addChild(c1);
	n1.gotoAndStop(2);
	this.addChild(numbg);
	this.addChild(n1);
	this.addChild(n2);
	this.addChild(n3);
	this.addChild(n4);
	this.addChild(h_mc);
	clearInterval(setintervalId);
	this["n" + prev].gotoAndStop(1);//先還原前一個按鈕顏色
	prev = 1;//再紀錄目前按鈕
	i = 2;
	setintervalId = setInterval($nextPic,4000);
}

n2.addEventListener(MouseEvent.CLICK,$playPic2);
function $playPic2($e:MouseEvent)
{
	h_mc.gotoAndPlay(25);
	c2.gotoAndPlay(1);
	this.addChild(c2);
	n2.gotoAndStop(2);
	this.addChild(numbg);
	this.addChild(n1);
	this.addChild(n2);
	this.addChild(n3);
	this.addChild(n4);
	this.addChild(h_mc);
	this["n" + prev].gotoAndStop(1);
	prev = 2;
	clearInterval(setintervalId);
	i = 3;
	setintervalId = setInterval($nextPic,4000);
}

n3.addEventListener(MouseEvent.CLICK,$playPic3);
function $playPic3($e:MouseEvent)
{
	h_mc.gotoAndPlay(25);
	c3.gotoAndPlay(1);
	this.addChild(c3);
	n3.gotoAndStop(2);
	this.addChild(numbg);
	this.addChild(n1);
	this.addChild(n2);
	this.addChild(n3);
	this.addChild(n4);
	this.addChild(h_mc);
	clearInterval(setintervalId);
	this["n" + prev].gotoAndStop(1);
	prev = 3;
	
	i = 4;
	setintervalId = setInterval($nextPic,4000);
}

n4.addEventListener(MouseEvent.CLICK,$playPic4);
function $playPic4($e:MouseEvent)
{
	h_mc.gotoAndPlay(25);
	c4.gotoAndPlay(1);
	this.addChild(c4);
	n4.gotoAndStop(2);
	this.addChild(numbg);
	this.addChild(n1);
	this.addChild(n2);
	this.addChild(n3);
	this.addChild(n4);
	this.addChild(h_mc);
	clearInterval(setintervalId);
	this["n" + prev].gotoAndStop(1);
	prev = 4;
		i = 1;
	setintervalId = setInterval($nextPic,4000);

}
</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div>
<script type="text/javascript">
swfobject.registerObject("FlashID");
</script>
</body>
<link href="../../Assert/syntaxhighlighter/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />
<script src="../../Assert/syntaxhighlighter/scripts/shCore.js" type="text/javascript"></script>
<script src="../../Assert/syntaxhighlighter/scripts/shAutoloader.js" type="text/javascript"></script>
<script src="../../Assert/syntaxhighlighter/scripts/shBrushAS3.js" type="text/javascript"></script>
<script src="../../Assert/syntaxhighlighter/scripts/shBrushXml.js" type="text/javascript"></script>
<script type="text/javascript">SyntaxHighlighter.all()</script>
<script>SyntaxHighlighter.defaults['toolbar'] = false;</script>
</html>
